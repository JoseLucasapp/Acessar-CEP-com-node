<meta charset="utf-8">
<html>
    <head>
        <title>JLchat</title>
    </head>
    <body>
        <div class="root">
            <div class="user">
                <form id="form">
                    <h1>User</h1>
                    <input id="username" type="text" />
                    <button id="userbtn">Ok</button>
                </form>
                <div class="online">
                    <h2>Online</h2>
                    <ul id="users"></ul>
                </div>
            </div>
            <div class="chat">
                <div class="campo_msg">
                    <ul class="msg" id="msg"></ul>
                </div>
                <form id="formmsg">
                    <input type="text" id="message" />
                    <button>Send</button>
                </form>
            </div>
        </div>
            
        <script src="/socket.io/socket.io.js"></script>
        <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
        <script>
            let socket = io();
            document.querySelector('#username').addEventListener('blur',(e)=>{
                document.querySelector('#username').readOnly = true;
                return false;
            });
            document.querySelector('#formmsg').addEventListener('submit',(e)=>{
                e.preventDefault();
                msg = document.getElementById('message').value;
                name = document.getElementById('username').value;
                socket.emit('message', msg, name);
                return false;
            });
            document.querySelector('#userbtn').addEventListener('click',(e)=>{
                e.preventDefault();
                document.querySelector('#userbtn').disabled = true;
                user = document.querySelector('#username').value;
                socket.emit('user', user);
                return false;
            })
            socket.on('message',(message,name)=>{
                $('#msg').append($('<li>').text(name + ': ' + message));
            });
            socket.on('user',(user)=>{
                $('#users').append($('<li>').text(user));
            });
        </script>

        <style>
            html, body {
                height: 100%;
            }
            *{margin: 0;padding: 0;box-sizing: border-box;}
            .user{
                position: absolute;
                width: 20%;
                height: 90%;
                margin-left: 5%;
                background-color: red;
                margin-top: 2.5%;
                text-align: center;
            }
            .user h1{
                margin-top: 10%;
                font-size: 25px;
                font-weight: bold;
                font-family: Verdana, Geneva, Tahoma, sans-serif;
            }
            .user input{
                margin-top: 5%;
                width: 90%;
                height: 5%;
                font-size: 20px;
            }
            .user button{
                margin-top: 5%;
                width: 30%;
                height: 5%;
                font-size: 15px;
            }
            .chat{
                position: absolute;
                width: 70%;
                height: 90%;
                background-color: rebeccapurple;
                margin-left: 25%;
                margin-top: 2.5%;
            }
            .chat form{
                position: absolute;
                margin-left: 5%;
                width: 100%;
                height: 10%;
                bottom: 1px;
            }
            .chat input{
                width: 70%;
                height: 50%;
            }
            .chat button{
                height: 50%;
                width: 20%;
            }
            .campo_msg{
                width: 80%;
                height: 70%;
                margin-left: 10%;
                margin-top: 5%;
                background-color: white;
                flex-direction: column;
                justify-content: center;
                overflow-y: scroll;
            }
            .campo_msg li{
                list-style: none;
                font-size: 20px;
                font-family: Verdana, Geneva, Tahoma, sans-serif;
                font-weight: bold;
            }
            .online{
                border-top: 1px solid black;
                width: 90%;
                margin-top: 5%;
                margin-left: 5%;
            }
            .online ul{
                margin-top: 2%;
                list-style: none;
                font-size: 20px;
            }
        </style>
    </body>
</html>